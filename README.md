# cd-headunit

–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∫–æ—Ñ–µ–º–∞—à–∏–Ω—ã –Ω–∞ Raspberry Pi: —Å–µ—Ç—å, MQTT, OTA-–≥–µ–π—Ç–≤–µ–π, –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã.

## üìÑ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é **HeadUnit OS (Native Edition)** ‚Äî –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –±–∞–∑–µ Linux (–±–µ–∑ Docker –≤ runtime), –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–µ–π —Ä–∞–±–æ—Ç—É –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–µ—Ä–∏—Ñ–µ—Ä–∏–µ–π.

---

## ‚öôÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–ª–æ—è (Layers), –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∏–º–µ–µ—Ç —Å–≤–æ–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª:

```text
builder/       ‚Äî –°–∫—Ä–∏–ø—Ç—ã —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ –û–° (PowerShell + Docker)
system/        ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É—Ä–æ–≤–Ω—è –û–° (systemd, udev, network)
services/      ‚Äî –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (DB, MQTT)
src/           ‚Äî –ü—Ä–∏–∫–ª–∞–¥–Ω–æ–π –∫–æ–¥ (Backend, Gateway, API)
external/      ‚Äî –ü–æ–¥–∫–ª—é—á–∞–µ–º—ã–µ –º–æ–¥—É–ª–∏ (cd-protocol –∏ –¥—Ä.)
docs/          ‚Äî –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–º. –≤ [`docs/architecture.md`](./docs/architecture.md).

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

- PowerShell 7+
- Docker Desktop (–∏–ª–∏ Engine –Ω–∞ Linux)
- Git

### 2. –°–±–æ—Ä–∫–∞

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–±–æ—Ä–∫–æ–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç `build.ps1`.

```powershell
# –°–±–æ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∞–≤—Ç–æ-–¥–µ—Ç–µ–∫—Ç)
.\build.ps1

# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ –û–°
.\build.ps1 -Force
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Å–±–æ—Ä–∫–µ: [`docs/building.md`](./docs/building.md).

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É —Ç–µ—Å—Ç–æ–≤ (BATS):

1. **Unit:** –¢–µ—Å—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å–±–æ—Ä–∫–∏.
2. **Image:** –¢–µ—Å—Ç—ã –≥–æ—Ç–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞ (`.img`).
3. **Runtime:** –°–∞–º–æ–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.

```powershell
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
.\build.ps1 -Test unit
.\build.ps1 -Test current
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [`docs/testing.md`](./docs/testing.md).

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](./docs/architecture.md)
- [–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (OverlayFS)](./docs/filesystem-architecture.md)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è](./docs/configuration.md)
- [–ú–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (OTA)](./docs/updating.md)

---

## üë• –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **Coffee Digital**
