# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ —Å–∏—Å—Ç–µ–º—ã (HeadUnit OS)

–°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –ø–æ –º–æ–¥—É–ª—å–Ω–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É. –°–∫—Ä–∏–ø—Ç-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç —ç—Ç–∞–ø—ã (`stages`), –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É—è –æ–±—Ä–∞–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ INI-—Ñ–∞–π–ª–∞.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```text
builder/
‚îú‚îÄ‚îÄ build.sh                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä)
‚îú‚îÄ‚îÄ headunit.conf           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–†–∞–∑–º–µ—Ä—ã, –ü–æ—å–∑–æ–≤–∞—Ç–µ–ª–∏, –°–µ—Ç—å)
‚îú‚îÄ‚îÄ lib/                    # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ (mount, logging, config parser)
‚îî‚îÄ‚îÄ stages/                 # –≠—Ç–∞–ø—ã —Å–±–æ—Ä–∫–∏
    ‚îú‚îÄ‚îÄ 01_make_image.sh    # –°–æ–∑–¥–∞–Ω–∏–µ .img —Ñ–∞–π–ª–∞ –∏ —Ä–∞–∑–º–µ—Ç–∫–∞ –¥–∏—Å–∫–∞
    ‚îú‚îÄ‚îÄ 02_rootfs.sh        # –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã (rsync)
    ‚îú‚îÄ‚îÄ 03_boot_config.sh   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ (fstab, cmdline)
    ‚îú‚îÄ‚îÄ 04_sys_config.sh    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –û–° (User, SSH, Network) —á–µ—Ä–µ–∑ chroot
    ‚îî‚îÄ‚îÄ 99_cleanup.sh       # –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ (umount, losetup)
```

## üöÄ –ó–∞–ø—É—Å–∫ —Å–±–æ—Ä–∫–∏

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Docker –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Å—Ä–µ–¥—ã —Å–±–æ—Ä–∫–∏. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ PowerShell –æ–±–µ—Ä—Ç–∫—É.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker Desktop (Windows/Mac/Linux)
- PowerShell (–∏–ª–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π bash)
- –ò—Å—Ö–æ–¥–Ω—ã–π –æ–±—Ä–∞–∑ Raspberry Pi OS Lite (–ø–æ–ª–æ–∂–∏—Ç—å –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞)

### –ö–æ–º–∞–Ω–¥—ã

**1. –°–±–æ—Ä–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (Dev Mode)**
–°–æ–∑–¥–∞–µ—Ç –æ–±—Ä–∞–∑ —Å –º–∞–ª–µ–Ω—å–∫–∏–º–∏ —Ä–∞–∑–¥–µ–ª–∞–º–∏-–∑–∞–≥–ª—É—à–∫–∞–º–∏ (Root B, Factory) –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–ø–∏—Å–∏ –Ω–∞ —Ñ–ª–µ—à–∫—É. SSH –≤–∫–ª—é—á–µ–Ω.

```powershell
.\build.ps1
# –∏–ª–∏ —è–≤–Ω–æ
.\build.ps1 -Mode dev
```

**2. –°–±–æ—Ä–∫–∞ –¥–ª—è —Ä–µ–ª–∏–∑–∞ (User Mode)**
–°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –æ–±—Ä–∞–∑ —Å —Ä–∞–±–æ—á–∏–º–∏ —Ä–∞–∑–¥–µ–ª–∞–º–∏ A/B –∏ Factory. SSH –≤—ã–∫–ª—é—á–µ–Ω (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).

```powershell
.\build.ps1 -Mode user
```

**3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (Debug)**
–í—Ö–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è —Ä—É—á–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤.

```powershell
.\build.ps1 -Interactive
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `builder/headunit.conf`.
–§–∞–π–ª –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: —Å–µ–∫—Ü–∏—è `[common]` –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º, –∑–∞—Ç–µ–º –Ω–∞–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (`[dev]` –∏–ª–∏ `[user]`).

**–ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `PART_ROOT_A_SIZE` ‚Äî —Ä–∞–∑–º–µ—Ä –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞.
- `SYS_ENABLE_SSH` ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ SSH ("yes"/"no").
- `NET_WIFI_SSID` ‚Äî –ø—Ä–µ–¥–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Wi-Fi –∫–ª–∏–µ–Ω—Ç–∞.
