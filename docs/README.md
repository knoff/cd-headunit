# cd-headunit

Headunit для Coffee Digital — управляющий блок кофемашины (Raspberry Pi).

## Назначение

- Локальный брокер MQTT (mTLS, ACL)
- OTA-кэш и зеркала прошивок
- Мини-S3 (MinIO) для артефактов
- PKI (step-ca)
- Пользовательский интерфейс (сенсорный экран)
- Мост SaaS ↔ MQTT
- Режим **read-only rootfs** с разделом `STATE` для данных

## Развёртывание

1. `ansible-playbook site.yml -i <pi_ip>` — быстрая установка.
2. Для производства — сборка образа через `pi-gen/`.
3. После старта: UI запускается первым, контейнеры поднимаются фоном.

## Безопасность

- Secure Boot Pi (при возможности)
- mTLS для всех подключений
- ACL на темы MQTT
- Разделение `SYSTEM` (RO) и `STATE` (RW)
