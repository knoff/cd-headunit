# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ HeadUnit OS (v1.0)

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (Monorepo), –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (OS Layer) –∏ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (App Layer).

## üèó –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```text
/
‚îú‚îÄ‚îÄ builder/                # [OS Layer] –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞
‚îÇ   ‚îú‚îÄ‚îÄ stages/             # –°–∫—Ä–∏–ø—Ç—ã —ç—Ç–∞–ø–æ–≤ (01..05)
‚îÇ   ‚îú‚îÄ‚îÄ assets/             # –ë–∏–Ω–∞—Ä–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (Splash, Boot logo)
‚îÇ   ‚îî‚îÄ‚îÄ headunit.conf       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ (INI)
‚îÇ
‚îú‚îÄ‚îÄ system/                 # [System Layer] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Linux (Stateless)
‚îÇ   ‚îú‚îÄ‚îÄ udev/               # –ü—Ä–∞–≤–∏–ª–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (persistent-net)
‚îÇ   ‚îú‚îÄ‚îÄ systemd/            # –Æ–Ω–∏—Ç-—Ñ–∞–π–ª—ã —Å–µ—Ä–≤–∏—Å–æ–≤ (rfkill, app-launcher)
‚îÇ   ‚îî‚îÄ‚îÄ boot/               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ (cmdline, config)
‚îÇ
‚îú‚îÄ‚îÄ services/               # [Infra Layer] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –ü–û
‚îÇ   ‚îú‚îÄ‚îÄ mqtt/               # –ö–æ–Ω—Ñ–∏–≥–∏ Mosquitto
‚îÇ   ‚îî‚îÄ‚îÄ database/           # –°–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
‚îÇ
‚îú‚îÄ‚îÄ src/                    # [App Layer] –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ backend/            # Python (FastAPI/Logic)
‚îÇ   ‚îú‚îÄ‚îÄ frontend/           # Web UI (React/Static)
‚îÇ   ‚îî‚îÄ‚îÄ updater/            # –ê–≥–µ–Ω—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
‚îÇ
‚îú‚îÄ‚îÄ deploy/                 # [Orchestration] Runtime –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.yml  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
‚îÇ
‚îî‚îÄ‚îÄ build.ps1               # –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è —Å–±–æ—Ä–∫–∏
```

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∏ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—É—é –º–æ–¥–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:

### 1. –°–ª–æ–π –û–° (Base OS)

- **–°–æ—Å—Ç–∞–≤:** –Ø–¥—Ä–æ, –¥—Ä–∞–π–≤–µ—Ä—ã, Docker Engine, NetworkManager, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑–¥–µ–ª–æ–≤.
- **–ú–µ—Ç–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∞ (A/B Partitioning –≤ –±—É–¥—É—â–µ–º) –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞.
- **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –¢–µ–≥–∏ git `vX.Y.0` (Major/Minor).

### 2. –°–ª–æ–π –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Application Stack)

- **–°–æ—Å—Ç–∞–≤:** Backend, Frontend, MQTT, –ë–î.
- **–ú–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞:** Docker Containers (–∏–∑–æ–ª—è—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π).
- **–ú–µ—Ç–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** `docker-compose pull && docker-compose up -d`.
- **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:** –ß–µ—Ä–µ–∑ Docker Volumes (–ø—Ä–æ–±—Ä–æ—Å –∫–æ–¥–∞ —Å —Ö–æ—Å—Ç–∞ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞).

## üõ† –°–µ—Ç–µ–≤–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∂–µ—Å—Ç–∫–æ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω—ã —á–µ—Ä–µ–∑ `udev` –ø—Ä–∞–≤–∏–ª–∞:

- **`wlan0` (Internal):** –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —á–∏–ø. –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω –¥–ª—è **Access Point (AP)**.
- **`wlan1` (External):** USB-–∞–¥–∞–ø—Ç–µ—Ä. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ **Client** (Internet/OTA).

## üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

- **System (`/`):** Read-Only (–≤ —Ü–µ–ª–µ–≤–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏).
- **Data (`/data`, p8):** Read-Write. –ó–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è:
  - Docker Volumes (–ë–î, –ª–æ–≥–∏).
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
  - –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (–≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏).
